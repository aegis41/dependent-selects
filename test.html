<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <select class="account" name="" id=""></select>
    <select class="client" name="" id=""></select>
    <select class="franchise" name="" id=""></select>
    <select class="location" name="" id=""></select>
</body>

</html>
<script>
    const accounts = [
        {
            id: 1,
            name: "Fisrve"
        },
        {
            id: 2,
            name: "Customer Next"
        }
    ];

    const clients = [
        {
            id: 1,
            accountID: 1,
            name: "Chik Fil-A"
        },
        {
            id: 2,
            accountID: 1,
            name: "Coldstone"
        },
        {
            id: 3,
            accountID: 1,
            name: "Cheesecake Factory"
        },
        {
            id: 4,
            accountID: 2,
            name: "Lowes"
        },
        {
            id: 5,
            accountID: 2,
            name: "Jersey Mikes"
        }
    ];

    const franchises = [
        {
            id: 1,
            clientID: 1,
            franchiseNo: 111,
            name: "Chicks of Fort Wayne"
        },
        {
            id: 2,
            clientID: 2,
            franchiseNo: 222,
            name: "Coldstone NE Indiana"
        },
        {
            id: 3,
            clientID: 3,
            franchiseNo: 333,
            name: "Windy Cheesecakes"
        },
        {
            id: 4,
            clientID: 2,
            franchiseNo: 223,
            name: "Coldstone 223"
        },
        {
            id: 5,
            clientID: 2,
            franchiseNo: 224,
            name: "Coldstone Creamery 224"
        },
        {
            id: 6,
            clientID: 4,
            franchiseNo: 0,
            name: "Lowes of California"
        },
        {
            id: 7,
            clientID: 5,
            franchiseNo: 18,
            name: "Ruth's Jersey Mikes"
        },
        {
            id: 8,
            clientID: 5,
            franchiseNo: 25,
            name: "Mike and Me, Inc."
        }
    ];

    locations = [
        {
            id: 1,
            franchiseID: 1,
            storeNo: 18,
            name: "Chick Store 18"
        },
        {
            id: 2,
            franchiseID: 1,
            storeNo: 21,
            name: "Chick Store 21"
        },
        {
            id: 3,
            franchiseID: 2,
            storeNo: 3,
            name: "CS 003"
        },
        {
            id: 4,
            franchiseID: 2,
            storeNo: 7,
            name: "CS 007"
        },
        {
            id: 5,
            franchiseID: 3,
            storeNo: 18,
            name: "Chick Store 18"
        },
        {
            id: 6,
            franchiseID: 4,
            storeNo: 118,
            name: "CS 118"
        },
        {
            id: 7,
            franchiseID: 5,
            storeNo: 64,
            name: "CS 064"
        },
        {
            id: 8,
            franchiseID: 6,
            storeNo: 423,
            name: "Lowe's 423 Modesto"
        }, {
            id: 9,
            franchiseID: 7,
            storeNo: 1,
            name: "RJM-1"
        }, {
            id: 10,
            franchiseID: 7,
            storeNo: 2,
            name: "RJM-2"
        }, {
            id: 11,
            franchiseID: 8,
            storeNo: 77,
            name: "JM 123"
        }, {
            id: 12,
            franchiseID: 8,
            storeNo: 123,
            name: "JM 123"
        },
    ];

    let fillSelect = function (selectElement, optionsArray) {
        let initialOption = document.createElement("option");
        initialOption.disabled = true;
        initialOption.selected = true;
        initialOption.value = null;
        initialOption.text = " -- Select an Option --"
        selectElement.add(initialOption);
        optionsArray.forEach((optionText) => {
            let option = document.createElement("option");
            option.text = optionText.name;
            option.value = optionText.id
            selectElement.add(option)
        }
        )
    };

    let emptySelect = function (selectElement) {
        let i, L = selectElement.options.length - 1;
        for (i = L; i >= 0; i--) {
            selectElement.remove(i);
        }
    }

    let remapOptions = function (options, filterValue, attrName) {
        if (filterValue.length === 1)
            return options.filter(option => option[attrName] === filterValue[0]);
    }

    let handleChange = function (selectElement, event, optionsArray, filterAttr) {
        let IDs = [parseInt(event.target.value)];
        let newOptions = remapOptions(optionsArray, IDs, filterAttr);
        emptySelect(selectElement);
        fillSelect(selectElement, newOptions);
    }

    const accountSelect = document.querySelector('.account');
    const clientSelect = document.querySelector('.client');
    const franchiseSelect = document.querySelector('.franchise');
    const locationSelect = document.querySelector('.location');

    accountSelect.addEventListener('change', (event) => {
        handleChange(clientSelect, event, clients, "accountID");
    });
    clientSelect.addEventListener('change', (event) => {
        handleChange(franchiseSelect, event, franchises, "clientID");
    });
    franchiseSelect.addEventListener('change', (event) => {
        handleChange(locationSelect, event, locations, "franchiseID");
    });
    // locationSelect.addEventListener('change', (event) => {
    //     console.log("Location changed");
    // });

    fillSelect(accountSelect, accounts);
    fillSelect(clientSelect, clients);
    fillSelect(franchiseSelect, franchises);
    fillSelect(locationSelect, locations);



</script>